<div data-ovh-alert="{{alerts.dashboard}}"></div>
<div class="page-header mb-5">
    <div class="row">
        <div class="col-sm-9">
            <span class="text-muted" data-i18n-static="sharepoint_dashboard_offer_type"></span>
            <h1 class="wordbreak" data-ng-bind="SharepointUrlCtrl.sharepointDomain"></h1>
        </div>
        <div class="col-sm-3 text-md-right">
            <p>
                <span class="fa fa-life-ring" aria-hidden="true"></span>
                <span data-i18n-static="sharepoint_dashboard_guides_help_label"></span><br>
                <a data-ng-href="{{SharepointCtrl.sharepointGuideUrl}}" target="_blank" title="{{tr('sharepoint_dashboard_guides_url')}}">
                    <span data-i18n-static="exchange_dashboard_guides_url"></span>
                    <span class="fa fa-external-link" aria-hidden="true"></span>
                </a>
            </p>
        </div>
    </div>
</div>

<div class="container-fluid px-5">

    <div data-ovh-alert="{{SharepointUrlCtrl.alerts.dashboard}}"></div>

    <div data-ng-show="!message">
        <h2 data-i18n-static="sharepoint_set_url_intro_title"></h2>
        <div class="mt-4" data-i18n-static="sharepoint_set_url_intro_label"></div>

        <form class="form-horizontal mt-5" name="activateSharepointForm"
              data-ng-submit="SharepointUrlCtrl.activatingSharepoint()">

            <div class="form-group">
                <label class="control-label col-md-2" for="urlSharepoint"
                       data-i18n-static="sharepoint_set_url_textfield_label"></label>
                <div class="col-md-4">
                    <div class="input-group">
                        <input type="text" class="form-control" id="urlSharepoint" max="256" placeholder="{{i18n.sharepoint_activate_url_placeholder}}" required
                               data-ng-model="SharepointUrlCtrl.sharepointUrl">
                        <span class="input-group-addon">
                            <span class="fa fa-spinner fa-spin" data-ng-hide="SharepointUrlCtrl.sharepointUrlSuffix" aria-hidden="true"></span>
                            <span data-ng-bind="SharepointUrlCtrl.sharepointUrlSuffix" data-ng-show="SharepointUrlCtrl.sharepointUrlSuffix"></span>
                        </span>
                    </div>
                </div>
            </div>

            <div class="row mt-5">
                <div class="col-md-6">
                    <div class="alert alert-warning" role="alert"
                         data-i18n-static="sharepoint_set_url_textfield_warn">
                    </div>
                </div>
            </div>

            <button class="btn btn-primary mt-5" type="submit"
                    data-i18n-static="sharepoint_set_url_button_label"
                    data-ng-disabled="activateSharepointForm.$invalid || !SharepointUrlCtrl.sharepointUrlSuffix">
            </button>
        </form>
    </div>

    <div data-ng-show="message">
        <div class="mt-3" data-i18n-static="sharepoint_set_url_success_message_title"></div>
        <strong data-ng-bind="tr('sharepoint_set_url_success_message_text', SharepointUrlCtrl.exchangeId)"></strong>
    </div>
</div>
